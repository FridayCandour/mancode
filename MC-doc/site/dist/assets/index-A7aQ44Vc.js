var C=Object.defineProperty;var R=(a,e,t)=>e in a?C(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var s=(a,e,t)=>(R(a,typeof e!="symbol"?e+"":e,t),t);function x(){import.meta.url,import("_").catch(()=>1);async function*a(){}}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();function g(a){const e=new DocumentFragment;for(let t of a)if(Array.isArray(t))e.appendChild(g(t));else{if(t instanceof m&&(t=t.render(void 0)),typeof t=="function"&&(t=t(),typeof t=="function"&&(t=t())),typeof t=="string"||typeof t=="number"){e.appendChild(document.createTextNode(t));continue}if(t instanceof HTMLElement||t instanceof DocumentFragment)e.appendChild(t);else if(typeof t<"u")throw new Error("  ✘  Cradova err:  invalid child type: "+t+" ("+typeof t+")")}return e}var E=(a,e)=>{let t={},i=null;if(e.length!==0)for(let r=0;r<e.length;r++){let n=e[r];if(typeof n=="function"&&(n=n()),n instanceof m&&(n=n.render()),n instanceof HTMLElement||n instanceof DocumentFragment){a.appendChild(n);continue}if(Array.isArray(n)){a.appendChild(g(n));continue}if(typeof n=="string"||typeof n=="number"){i=n;continue}if(typeof n=="object"){t=Object.assign(t,n);continue}}else return a;if(typeof t=="object"&&a)for(const[r,n]of Object.entries(t)){if(r==="style"&&typeof n=="object"){Object.assign(a.style,n);continue}if(r.includes("data-")){a.setAttribute(r,n);continue}if(r.includes("aria-")){a.setAttribute(r,n);continue}if(r==="href"&&typeof n=="string"){const l=n||"";l.includes("://")||a.addEventListener("click",f=>{var c;f.preventDefault(),_.navigate(a.pathname);//! get url hash here and scroll into view
if(l.includes("#")){const b=l.split("#").at(-1);(c=document.getElementById("#"+b))==null||c.scrollIntoView()}}),a.setAttribute(r,n);continue}if(typeof a.style[r]<"u"&&r!=="src"){a.style[r]=n;continue}if(Array.isArray(n)){if(r=="reference"&&n[0]instanceof v){n[0]._appendDomForce(n[1],a);continue}if(n[0]instanceof k){n[0].bindRef(a,{_element_property:r,signalProperty:n[1]});continue}}if(r==="onmount"&&typeof t.onmount=="function"){const l=()=>{var f;(f=t.onmount)==null||f.apply(a),t.onmount=void 0};h.addEventListener("onmountEvent",l);continue}a[r]=n}return i&&a.appendChild(document.createTextNode(i)),a},w=a=>(...t)=>E(document.createElement(a),t),u={snru:"",memo_SNRU(){let a=0;const e=window.location.href;for(let t=0;t<e.length;t++)a+=e.charCodeAt(t);this.snru=a.toString()}};class S{constructor(){s(this,"listeners",{});s(this,"active_listeners",{})}async addEventListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}async addActiveEventListener(e,t){this.active_listeners[e]||(this.active_listeners[e]=[]),this.active_listeners[e].push(t)}async dispatchEvent(e,t){const i=this.listeners[e]||[];for(;i.length!==0;)i.shift()(t)}async dispatchActiveEvent(e,t){const i=this.active_listeners[e]||[];i.length&&u.memo_SNRU();for(let r=0;r<i.length;r++)i[r](t)}}var h=new S;class m{constructor(e){s(this,"component");s(this,"effects",[]);s(this,"effectuate",null);s(this,"methods",{});s(this,"rendered",!1);s(this,"published",!1);s(this,"preRendered",null);s(this,"reference",new v);s(this,"Signal");s(this,"_state",[]);s(this,"_state_track",{});s(this,"_state_index",0);s(this,"stash");this.component=e.bind(this),h.addActiveEventListener("active-Refs",()=>{this._state_index=0,this.published=!1})}preRender(e,t){this.preRendered=this.render(e,t)}destroyPreRendered(){this.preRendered=null}define(e,t){typeof e=="string"&&typeof t=="function"&&!Object.prototype.hasOwnProperty.call(this,e)?this.methods[e]=t.bind(this):console.error(" ✘  Cradova err :  Invalid Ref.define parameters")}render(e,t){if(this.effects=[],this.rendered=!1,t&&(this.stash=e),this.preRendered)return this.preRendered;{const i=this.component(e);return i instanceof HTMLElement||i instanceof DocumentFragment?(this.reference._appendDomForce("html",i),this.effector.apply(this),this.rendered=!0,this.published=!0):console.error(" ✘  Cradova err :  Invalid html content, got  - "+i),i}}instance(){return this.reference.current("html")}_setExtra(e){this.Signal=e}_roll_state(e,t,i=!1){return i||(this._state[t]=e),this._state[t]}_effect(e){this.rendered||this.effects.push(e.bind(this))}async effector(){for(let e=0;e<this.effects.length;e++)await this.effects[e].apply(this);this.effects=[],this.effectuate&&(this.effectuate(),this.effectuate=null)}updateState(e,t){this.rendered?this.published&&this.Activate(e):this.effectuate=()=>{this.published&&this.Activate(e)},t&&(this.stash=e)}async Activate(e){if(this._state_index=0,this.published=!1,!this.rendered)return;const t=this.component(e);if(t instanceof HTMLElement||t instanceof DocumentFragment){const i=this.reference.current("html");i&&(i.insertAdjacentElement("beforebegin",t),i.remove()),this.published=!0,this.reference._appendDomForce("html",t),h.dispatchEvent("onmountEvent")}else console.error(" ✘  Cradova err :  Invalid html content, got  - "+t)}}class v{constructor(){s(this,"tree",{});s(this,"globalTree",{})}bindAs(e){return[this,e]}current(e){return this.tree[u.snru]?this.tree[u.snru][e]:null}_appendDomForce(e,t){this.tree[u.snru]?this.tree[u.snru][e]=t:(this.tree[u.snru]={},this.tree[u.snru][e]=t)}_appendDomForceGlobal(e,t){this.globalTree[e]=t}}var d=new v;class k{constructor(e,t){s(this,"callback");s(this,"persistName","");s(this,"actions",{});s(this,"ref",[]);s(this,"value");if(this.value=e,t&&t.persistName){this.persistName=t.persistName;const i=localStorage.getItem(t.persistName);if(i&&i!=="undefined"&&(this.value=JSON.parse(i)),typeof e=="object")for(const r in e)Object.prototype.hasOwnProperty.call(this.value,r)||(this.value[r]=e[r])}}set(e,t){typeof e=="function"?this.value=e(this.value):this.value=e,this.persistName&&localStorage.setItem(this.persistName,JSON.stringify(this.value)),this.ref.length&&t!==!1&&this._updateState(),this.callback&&this.callback(this.value)}setKey(e,t,i){if(typeof this.value=="object"&&!Array.isArray(this.value))this.value[e]=t,this.persistName&&localStorage.setItem(this.persistName,JSON.stringify(this.value)),this.ref.length&&i!==!1&&this._updateState(),this.callback&&this.callback(this.value);else throw new Error("✘  Cradova err : can't set key ".concat(String(e)," . store.value is not a javascript object"))}createAction(e,t){if(typeof e=="string"&&typeof t=="function")this.actions[e]=t;else throw new Error("✘  Cradova err : can't create action, ".concat(e," is not a function"))}createActions(e){for(const[t,i]of Object.entries(e))if(typeof t=="string"&&typeof i=="function")this.actions[t]=i;else throw new Error("✘  Cradova err : can't create action, ".concat(t," is not a function"))}fireAction(e,t){if(this._updateState(e,t),typeof this.actions[e]=="function")return this.actions[e].call(this,t);throw Error("✘  Cradova err : action "+e+"  does not exist!")}bind(e){if(typeof this.value=="object"&&typeof this.value[e]<"u")return[this,e];throw new Error("✘  Cradova err : can't bind an unavailable property!  "+e)}_updateState(e,t){if(e&&t)this.ref.map(i=>{if(i._event===e){if(i._element_property&&i._signalProperty){i.ref.updateState({[i._element_property]:t[i._signalProperty]});return}if(i._element_property){i.ref.updateState({[i._element_property]:t});return}if(i._signalProperty){i.ref.updateState(t[i._signalProperty]);return}}});else for(let i=0;i<this.ref.length;i++){const r=this.ref[i];if(r._element_property&&r._signalProperty){r.ref.updateState({[r._element_property]:this.value[r._signalProperty]});continue}if(r._element_property){r.ref.updateState({[r._element_property]:this.value});continue}if(r._signalProperty){r.ref.updateState(this.value[r._signalProperty]);continue}if(!r._element_property&&!r._signalProperty){r.ref.updateState(this.value);continue}}}bindRef(e,t={signalProperty:"",_element_property:""}){e.render=e.render.bind(e,this.value),e._setExtra(this),this.ref.push({ref:e,_signalProperty:t.signalProperty,_element_property:t._element_property,_event:t.event})}listen(e){this.callback=e}clearPersist(){this.persistName&&localStorage.removeItem(this.persistName)}}class p{constructor(e){s(this,"_name");s(this,"_html");s(this,"_packed",!1);s(this,"_template",document.createElement("div"));s(this,"_callBack");s(this,"_deCallBack");s(this,"_persist",!0);s(this,"_delegatedRoutesCount",-1);s(this,"_dropped",!1);s(this,"_errorHandler",null);const{template:t,name:i,persist:r,renderInParallel:n}=e;t instanceof m?this._html=()=>t.render({}):this._html=t,this._name=i||"Document",this._template.setAttribute("id","cradova-screen-set"),n===!0?(this._delegatedRoutesCount=0,this._persist=!1):typeof r=="boolean"&&(this._persist=r)}_derive(){return{_name:this._name,_callBack:this._callBack,_deCallBack:this._deCallBack}}_apply_derivation(e){this._name=e._name,this._callBack=e._callBack,this._deCallBack=e._deCallBack}get _delegatedRoutes(){return this._delegatedRoutesCount>100?-1:this._delegatedRoutesCount}set _delegatedRoutes(e){e&&(this._delegatedRoutesCount+=1)}setErrorHandler(e){this._errorHandler=e}async _package(){if(u.memo_SNRU(),typeof this._html=="function"){let e=await this._html.apply(this);if(typeof e=="function")e=e(),(e instanceof HTMLElement||e instanceof DocumentFragment)&&(this._template.innerHTML="",this._template.appendChild(e));else if(e instanceof HTMLElement||e instanceof DocumentFragment)this._template.innerHTML="",this._template.appendChild(e);else throw new Error(" ✘  Cradova err:  template function for the screen with name '".concat(this._name,"' returned ").concat(e," instead of html"))}}onActivate(e){this._callBack=e}onDeactivate(e){this._deCallBack=e}async _deActivate(){this._deCallBack&&await this._deCallBack(d.globalTree.doc)}drop(e){if(typeof e=="boolean"){this._dropped=e;return}else return this._dropped}async _Activate(e=!1){if(this._dropped){history.go(-1);return}h.dispatchActiveEvent("active-Refs"),(!this._persist||e||!this._packed)&&(await this._package(),this._packed=!0),document.title=this._name,d.globalTree.doc.innerHTML="",d.globalTree.doc.appendChild(this._template),h.dispatchEvent("onmountEvent"),window.scrollTo({top:0,left:0,behavior:"instant"}),this._callBack&&await this._callBack(d.globalTree.doc)}}class A{constructor(){s(this,"lastNavigatedRouteController");s(this,"nextRouteController");s(this,"lastNavigatedRoute");s(this,"pageShow",null);s(this,"pageHide",null);s(this,"errorHandler");s(this,"loadingScreen",null);s(this,"params",{});s(this,"routes",{});s(this,"pageevents",[]);s(this,"paused",!1)}async start_pageevents(e){setTimeout(()=>{for(let t=0;t<this.pageevents.length;t++)this.pageevents[t](e)},50)}route(e,t){if(typeof t<"u"){if(t&&!t)throw console.error(" ✘  Cradova err:  not a valid screen  ",t),new Error(" ✘  Cradova err:  Not a valid cradova screen component");return this.routes[e]=t}}async router(e,t){let i=window.location.pathname,r,n;if(this.paused){window.location.hash="paused";return}if(i!==this.lastNavigatedRoute)if(this.nextRouteController?(r=this.nextRouteController,this.nextRouteController=void 0):[r,n]=this.checker(i),typeof r<"u")try{if(typeof r=="function"&&(this.loadingScreen instanceof p&&await this.loadingScreen._Activate(),r=await r(),!r)){this.lastNavigatedRoute&&history.pushState({},i,this.lastNavigatedRoute);return}if(r._delegatedRoutes!==-1){r._delegatedRoutes=1;const l=r._derive();r=new p({template:r._html}),r._apply_derivation(l),this.routes[i]=r}n&&(this.params.params=n),await r._Activate(t),this.start_pageevents(i),this.lastNavigatedRouteController&&this.lastNavigatedRouteController._deActivate(),this.lastNavigatedRoute=i,this.lastNavigatedRouteController=r}catch(l){if(r&&r._errorHandler)r._errorHandler(l);else if(typeof this.errorHandler=="function")this.errorHandler(l);else throw console.error(l),new Error(" ✘  Cradova err:  consider adding error boundary to the specific screen  ")}else this.routes["*"]&&await this.routes["*"]._Activate(t)}checker(e){if(this.routes[e])return[this.routes[e],{path:e}];if(this.routes[e+"/"])return[this.routes[e],{path:e}];for(const t in this.routes){if(!t.includes(":"))continue;const i=e.split("/"),r=t.split("/");e.endsWith("/")&&i.pop();let n=0,l=0;if(i.shift(),r.shift(),r.length===i.length){const f={_path:""};for(let c=0;c<r.length;c++){if(r[c].includes(":")){l++;continue}i[c]===r[c]&&n++}if(n+l===r.length){for(let c=0;c<r.length;c++)r[c].includes(":")&&(f[r[c].split(":")[1]]=i[c]);return f._path=t,[this.routes[t],f]}}}return[]}}var o=new A;class _{static BrowserRoutes(e){for(const t in e){let i=e[t];typeof i=="object"&&typeof i.then=="function"||typeof i=="function"?o.routes[t]=async()=>(i=await(typeof i=="function"?await i():await i),o.route(t,(i==null?void 0:i.default)||i)):o.route(t,i)}_._mount()}static back(){history.go(-1)}static forward(){history.go(1)}static pauseNaviagtion(){o.paused=!0,window.location.hash="paused"}static resumeNaviagtion(){o.paused=!1,window.location.replace(window.location.pathname+window.location.search),history.go(-1)}static navigate(e,t=null,i=!1){if(typeof e!="string")throw new TypeError(" ✘  Cradova err:  href must be a defined path but got "+e+" instead");let r=null,n;if(e.includes("://"))window.location.href=e;else{if(e===window.location.pathname)return;[r,n]=o.checker(e),r&&(o.nextRouteController=r,window.history.pushState({},"",e)),o.params.params=n,o.params.data=t,o.router(null,i)}}static setLoadingScreen(e){if(e instanceof p)o.loadingScreen=e;else throw new Error(" ✘  Cradova err:  Loading Screen should be a cradova screen class")}static onPageEvent(e){if(typeof e=="function")o.pageevents.push(e);else throw new Error(" ✘  Cradova err:  callback for pageShow event is not a function")}static async packageScreen(e){if(!o.routes[e])throw console.error(" ✘  Cradova err:  no screen with path "+e),new Error(" ✘  Cradova err:  cradova err: Not a defined screen path");let[t]=o.checker(e);if(typeof t=="function"&&(t=await t()),t._delegatedRoutes!==-1){t._delegatedRoutes=1;const i=t._derive();t=new p({template:t._html}),t._apply_derivation(i),o.routes[e]=t}t._package(),t._packed=!0}static get Params(){return o.params}static addErrorHandler(e){if(typeof e=="function")o.errorHandler=e;else throw new Error(" ✘  Cradova err:  callback for error event is not a function")}static _mount(){let e=document.querySelector("[data-wrapper=app]");e||(e=document.createElement("div"),e.setAttribute("data-wrapper","app"),document.body.appendChild(e)),d._appendDomForceGlobal("doc",e),window.addEventListener("pageshow",()=>o.router()),window.addEventListener("popstate",t=>{t.preventDefault(),o.router()})}}var N=w("div"),L=w("h1");const y=new p({name:"Mancode forum",template(){return N(L("Mancode forum"))}});_.BrowserRoutes({"/forum":y,"/":y});export{x as __vite_legacy_guard};
